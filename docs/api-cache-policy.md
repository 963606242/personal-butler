# 外部 API 缓存策略

免费外部接口均做缓存，减少请求、节省额度；该实时调用的保持实时。

## 新闻

| API | 缓存规则 | 说明 |
|-----|----------|------|
| 天聚数行 | 早 / 午 / 晚 时间段 | 免费 QPS=3，按时间段缓存，命中不请求 |
| NewsAPI | 早 / 午 / 晚 时间段 | 国内 / 国外分开缓存 |
| 早报 / 晚报 | 按日 | 当日缓存，次日重新生成 |

## 天气（OpenWeatherMap）

| 类型 | 缓存规则 | 说明 |
|------|----------|------|
| 当前天气 | 同城同日 | key: `当前城市 lat_lon_YYYY-MM-DD`，过期当日结束 |
| 天气预报 | 同城同日 | key: `forecast_lat_lon_YYYY-MM-DD`，过期当日结束 |
| 城市搜索 | **不缓存** | 实时调用，便于选城市 |

刷新按钮会 `skipCache` 强制拉最新数据。

## 日历（holiday.ailcc.com）

| 类型 | 缓存规则 | 说明 |
|------|----------|------|
| 某年数据 | 按年 localStorage | 同一年只请求一次，之后读本地 |

## 小结

- **该缓存**：天气（同城同日）、新闻（时间段）、日历（按年）、早报晚报（按日）。
- **该实时**：城市搜索、其余未列出的查询类接口。
